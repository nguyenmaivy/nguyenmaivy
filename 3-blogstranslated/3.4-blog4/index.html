<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="vynguyen08257@gmail.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 4 :: Internship Report</title>
<link href=../../css/nucleus.css?1765465501 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765465501 rel=stylesheet><link href=../../css/hybrid.css?1765465501 rel=stylesheet><link href=../../css/featherlight.min.css?1765465501 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765465501 rel=stylesheet><link href=../../css/auto-complete.css?1765465501 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765465501 rel=stylesheet><link href=../../css/theme.css?1765465501 rel=stylesheet><link href=../../css/hugo-theme.css?1765465501 rel=stylesheet><link href=../../css/theme-workshop.css?1765465501 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765465501></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.4-blog4/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765465501></script><script type=text/javascript src=../../js/auto-complete.js?1765465501></script><script type=text/javascript>var baseurl="https://nguyenmaivy.github.io/nguyenmaivy/"</script><script type=text/javascript src=../../js/search.js?1765465501></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Worklog Week 10" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Worklog Week 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Worklog Week 9" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Worklog Week 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Worklog Week 11" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Worklog Week 11
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2.</b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.4-blog4/ title="Blog 4" class="dd-item
active"><a href=../../3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.5-blog5/ title="Blog 5" class=dd-item><a href=../../3-blogstranslated/3.5-blog5/><b>3.6. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.6-blog6/ title="Blog 5" class=dd-item><a href=../../3-blogstranslated/3.6-blog6/><b>3.6. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.7-blog7/ title="Blog 7" class=dd-item><a href=../../3-blogstranslated/3.7-blog7/><b>3.7. </b>Blog 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.8-blog8/ title="Blog 8" class=dd-item><a href=../../3-blogstranslated/3.8-blog8/><b>3.8. </b>Blog 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.9-blog9/ title="Blog 9" class=dd-item><a href=../../3-blogstranslated/3.9-blog9/><b>3.9. </b>Blog 9
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title=Introduction class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title=Prerequiste class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>Prerequiste
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-s3-vpc/ title="Access S3 from VPC" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/><b>5.3. </b>Access S3 from VPC
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.3-s3-vpc/5.3.1-create-gwe/ title="Create a gateway endpoint" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/5.3.1-create-gwe/><b>5.3.1 </b>Create a gateway endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-s3-vpc/5.3.2-test-gwe/ title="Test the Gateway Endpoint" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/5.3.2-test-gwe/><b>5.3.2 </b>Test the Gateway Endpoint
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.4-s3-onprem/ title="Access S3 from on-premises" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/><b>5.4. </b>Access S3 from on-premises
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.1-prepare/ title="Prepare the environment" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.1-prepare/><b>5.4.1 </b>Prepare the environment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/ title="Create an S3 Interface endpoint" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/><b>5.4.2 </b>Create an S3 Interface endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/ title="Test the Interface Endpoint" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/><b>5.4.3 </b>Test the Interface Endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/ title="On-premises DNS Simulation" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/><b>5.4.4 </b>On-premises DNS Simulation
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.5-policy/ title="VPC Endpoint Policies" class=dd-item><a href=../../5-workshop/5.5-policy/><b>5.5. </b>VPC Endpoint Policies
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-cleanup/ title="Clean up" class=dd-item><a href=../../5-workshop/5.6-cleanup/><b>5.6. </b>Clean up
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing, Contributing Opinions" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing, Contributing Opinions
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://nguyenmaivy.github.io/nguyenmaivy/3-blogstranslated/3.4-blog4/ selected>English</option><option id=vi value=https://nguyenmaivy.github.io/nguyenmaivy/vi/3-blogstranslated/3.4-blog4/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 4</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#architecting-a-secure-and-isolated-runtime-environment>Architecting a secure and isolated runtime environment</a></li><li><a href=#understanding-the-runtime-deprecation-process>Understanding the runtime deprecation process</a><ul><li><a href=#applying-the-solution>Applying the solution</a></li><li><a href=#identify-and-clean-up-unused-functions>Identify and clean up unused functions</a></li></ul></li><li><a href=#prioritizing-upgrades>Prioritizing upgrades</a></li><li><a href=#empowering-engineering-teams-with-automated-tools-and-knowledge>Empowering engineering teams with automated tools and knowledge</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 4</h1><h1 id=how-zapier-runs-isolated-tasks-on-aws-lambda-and-upgrades-functions-at-scale>How Zapier runs isolated tasks on AWS Lambda and upgrades functions at scale</h1><p>by Anton Aleksandrov, Raúl Negrón-Otero, Ankush Kalra, Vítek Urbanec, and Chandresh Patel on 25 JUL 2025 in <a href=https://aws.amazon.com/blogs/architecture/category/learning-levels/advanced-300/>Advanced (300)</a>, <a href=https://aws.amazon.com/blogs/architecture/category/management-tools/amazon-cloudwatch/>Amazon CloudWatch</a>, <a href=https://aws.amazon.com/blogs/architecture/category/compute/amazon-kubernetes-service/>Amazon Elastic Kubernetes Service</a>, <a href=https://aws.amazon.com/blogs/architecture/category/architecture/>Architecture</a>, <a href=https://aws.amazon.com/blogs/architecture/category/compute/aws-lambda/>AWS Lambda</a>, <a href=https://aws.amazon.com/blogs/architecture/category/post-types/customer-solutions/>Customer Solutions</a>, <a href=https://aws.amazon.com/blogs/architecture/category/management-and-governance/monitoring-and-observability/>Monitoring and observability</a>, <a href=https://aws.amazon.com/blogs/architecture/category/serverless/>Serverless</a></p><p><a href=https://zapier.com/>Zapier</a> is a leading no-code automation provider whose customers use their solution to automate workflows and move data across over 8,000 applications such as Slack, Salesforce, Asana, and Dropbox. Zapier runs these automations through integrations called Zaps, which are implemented using a serverless architecture running on <a href=https://aws.amazon.com/>Amazon Web Services</a> (AWS). Each Zap is powered by an <a href=https://aws.amazon.com/lambda/>AWS Lambda</a> fuction.</p><p>In this post, you’ll learn how Zapier has built their serverless architecture focusing on three key aspects: using Lambda functions to build isolated Zaps, operating over a hundred thousand Lambda functions through Zapier’s control plane infrastructure, and enhancing security posture while reducing maintenance efforts by introducing automated function upgrades and cleanup workflows into their platform architecture.</p><h2 id=architecting-a-secure-and-isolated-runtime-environment>Architecting a secure and isolated runtime environment</h2><p>Zaps created by Zapier’s users implement tenant-specific business logic, hence they require cross-tenant compute isolation. Code implementing one Zap can’t share an execution environment with code implementing another Zap. Moreover, the same Zap type used by two different tenants can’t share execution environments as well.</p><p>To achieve the required level of isolation, Zapier’s engineering team adopted <a href=https://aws.amazon.com/lambda/>AWS Lambda</a>, a serverless compute service that runs code in response to events and automatically manages cloud compute resources. Minimal <a href=https://docs.aws.amazon.com/lambda/latest/dg/welcome.html>operational overhead</a>, <a href=https://docs.aws.amazon.com/lambda/latest/dg/security-resilience.html>built-in high availability</a>, <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-concurrency.html>automated scaling</a>, <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtime-environment.html>high level of isolation</a>, and <a href=https://aws.amazon.com/lambda/pricing/>pay-per-use model</a> made Lambda a great fit for this use case. Currently, Zapier’s architecture is running over a hundred thousand Lambda functions to support their customer’s integration workflows
Because they’re powered by the open source <a href=https://firecracker-microvm.github.io/>Firecracker microVMs</a>, each function is completely isolated from the others. Moreover, each execution environment belonging to the same function (sometimes referred to as function instances) is also isolated from other execution environments. The following architecture topology diagram uses red lines to represent isolation boundaries. Each execution environment of every function is isolated from its peers and is getting its own virtual resources such as disk, memory, and CPU. For more details, read <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-security.html>Security in AWS Lambda</a>.</p><blockquote><p>*Image 1. *</p></blockquote><p>Zapier’s control plane is architected using <a href=https://aws.amazon.com/eks/>Amazon Elastic Kubernetes Service</a> (Amazon EKS). A designated database is used to maintain the up-to-date function inventory. Whenever a user creates a new Zap, the control plane creates a corresponding Lambda function and stores a reference in the inventory database. When a Zap is triggered, the control plane retrieves information about a relevant Lambda function and invokes it to facilitate the integration workflow, as illustrated in the following diagram.</p><blockquote><p>*Image 2. *</p></blockquote><h2 id=understanding-the-runtime-deprecation-process>Understanding the runtime deprecation process</h2><p>When building architectures using the traditional non-serverless compute, cloud engineers are the ones responsible for keeping operating systems and software on their compute instances up to date and applying security and maintenance patches. With serverless architectures and Lambda functions, security patches and minor <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html>runtime</a> upgrades are handled by AWS automatically, which means customers can focus on delivering business value instead of the undifferentiated heavy lifting of infrastructure management.
When a major Lambda managed runtime version reaches end-of-life, AWS initiates a <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html#runtime-support-policy>deprecation process</a> through the <a href=https://docs.aws.amazon.com/health/latest/ug/aws-health-dashboard-status.html>AWS Health Dashboard</a> and direct email communications to affected customers. Because deprecated runtimes eventually lose access to security updates and support, organizations must upgrade to supported runtime versions to avoid potential security risks. Read more about the <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html#runtimes-shared-responsibility>shared responsibility model</a>, <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html#runtime-deprecation-levels>runtime use after deprecation</a>, and <a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html#runtime-deprecation-notify>receiving runtime deprecation notifications</a>.</p><p>As Zapier’s user base and architectural complexity – and consequently the number of Zaps – were growing, keeping all functions on the most up-to-date major runtime versions became a laborious task. Top contributing factors were:</p><ul><li><p>High number of functions. At its peak, the Zapier platform was running Zaps using hundreds of thousands of unique Lambda functions. Approximately 35% of these functions were using a runtime that was scheduled for deprecation in the next 12 months.</p></li><li><p>Zapier architected their data plane environment to be ephemeral – the control plane creates and deletes Lambda functions on demand and manages their lifecycle dynamically. Identifying a specific owner for each affected function wasn’t always straightforward.</p></li><li><p>Security is paramount at Zapier and upgrading affected functions runtime prior to the deprecation date was an absolute must. At no point could Zapier functions use runtimes after their deprecation date. This was a task which required extra resources.</p></li><li><p>The upgrade process shouldn’t have had any impact on the end customer experience. At no point should customer experience be affected.
With a short runway, high-volume workload, and the strict requirements of not impacting customer experience, Zapier’s Platform Engineering team took on this challenge of maintaining high security posture in their platform architecture.</p></li></ul><h3 id=applying-the-solution>Applying the solution</h3><p>The solution had three work streams:</p><ol><li>Reducing the risk by analyzing the architecture and identifying and cleaning up unused functions.</li><li>Prioritizing upgrades by identifying the most critical and impactful functions.</li><li>Empowering engineering teams with automated tools and knowledge to streamline the upgrade process in future.</li></ol><h3 id=identify-and-clean-up-unused-functions>Identify and clean up unused functions</h3><p>The first step in streamlining the upgrade process was identifying and removing unused functions. This reduced the total number of functions in Zapier’s architecture that required upgrades, eliminating unnecessary work for the team.
Zapier started by augmenting the function inventory with runtime information using <a href=https://aws.amazon.com/premiumsupport/technology/trusted-advisor/>AWS Trusted Advisor</a> and <a href=https://catalog.workshops.aws/awscid/en-US/dashboards/advanced/trusted-advisor>Amazon Cloud Intelligence Trusted Advisor dashboards</a>, as illustrated in the following diagram.</p><blockquote><p>*Image 3. *</p></blockquote><p>This meant the team could build a detailed inventory of functions that were running on soon-to-be deprecated runtimes. Using <a href=https://aws.amazon.com/cloudwatch/>Amazon CloudWatch</a>, Zapier’s platform team started to monitor metrics such as <a href=https://docs.aws.amazon.com/lambda/latest/dg/monitoring-metrics-types.html#invocation-metrics>number of invocations</a>. They identified which functions were active, which functions weren’t used for an extended period, and which functions didn’t have an active owner and could be removed.
One of the primary mechanisms for ownership validation within the organization was using <a href=https://docs.aws.amazon.com/whitepapers/latest/tagging-best-practices/what-are-tags.html>resource tags</a>. Functions that were active, but didn’t have clear ownership, were flagged for additional review before removal. Functions that were confirmed as unused or didn’t have an active owner were marked for deletion. Removing such functions allowed Zapier to significantly simplify their architecture and reduce the number of functions that had to be upgraded.</p><h2 id=prioritizing-upgrades>Prioritizing upgrades</h2><p>With a smaller volume of functions to upgrade, Zapier’s platform team prioritized function upgrades based on usage patterns, criticality, and potential customer impact. Three primary prioritization categories were:</p><ul><li><p>Customer-facing functions – Any functions directly involved in executing user Zaps were marked as high priority. These had to be upgraded first to avoid service disruptions.</p></li><li><p>Backend infrastructure functions – Internal functions that supported system operations were evaluated based on their importance to platform stability.</p></li><li><p>High-volume functions – Functions with the highest execution frequency were prioritized because upgrading them would have the greatest impact on reducing operational risk.</p></li></ul><p>Using these factors, Zapier’s platform team has created an upgrade roadmap, ensuring that critical assets were addressed first while minimizing potential disruptions.</p><p>Refer to <a href=https://docs.aws.amazon.com/lambda/latest/dg/runtimes-list-deprecated.html>Retrieve data about Lambda functions that use a deprecated runtime</a> in the Lambda Developer Guide to learn how to identify most commonly and most frequently used Lambda functions in your serverless architecture.</p><h2 id=empowering-engineering-teams-with-automated-tools-and-knowledge>Empowering engineering teams with automated tools and knowledge</h2><p>To ensure a smooth and efficient upgrade process across their serverless architecture, Zapier’s team empowered engineering teams with clear guidelines and automated solutions. The platform incorporated two main approaches: Terraform-managed functions and a custom-built Lambda runtime canary tool. Implementing and adopting these tools and practices resulted in reducing the number of functions using soon-to-be deprecated runtimes by 95%.
For functions managed through <a href=https://aws.amazon.com/what-is/iac/>infrastructure-as-code</a> (IaC), Zapier’s team developed standardized Terraform modules that specified supported runtime versions. Development teams implemented these modules in their configurations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>resource &#34;aws_lambda_function&#34; &#34;example&#34; {</span>
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>runtime = &#34;python3.13&#34; </span> <span style=color:#75715e># Updated to supported runtime</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>After applying the new module version, teams validated changes by testing the new runtime in staging environments and monitoring Terraform plan outputs to ensure proper runtime version updates.
To efficiently manage most Lambda functions in their architecture, Zapier developed the Lambda runtime canary tool suite. Using this solution, they automated the runtime upgrade process for thousands of active Lambda functions with minimal manual intervention. The tool suite implements several key features:</p><ul><li><p>Architected for gradual traffic shifting with the Lambda built-in routing mechanism through function <a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html>version</a> and <a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html>aliasing</a>. The tool can gradually shift traffic distribution from an old to a new function version. During this gradual traffic shift, the system monitors <a href=https://docs.aws.amazon.com/lambda/latest/dg/monitoring-metrics-types.html>CloudWatch metrics</a> for errors and automatically rolls back if error rates exceed acceptable thresholds.</p></li><li><p>Optimistic upgrade strategy implements direct upgrades for infrequently used functions using a flag value stored in a cache to detect potential issues during the first post-upgrade invocation. If this invocation fails, the control plane retries it using the previous function version. If the retried invocation succeeds, Zapier’s control plane initiates a rollback, assuming the error is most likely due to the runtime upgrade. After rollback, it will log the error and alert relevant stakeholders.</p></li><li><p>Integration with existing infrastructure uses an administrative interface and task queue for automated traffic shifting. A database ledger maintains tracking of function states and rollback information.</p></li><li><p>Operational controls provide manual rollback capabilities and implement centralized control switches for process management. After a function was upgraded to a new runtime and no rollback activity was detected within a set time period, an automated pruning task cleans up older versions.</p></li></ul><p>Zapier’s Lambda canary tool, through its integration of gradual traffic shifting, real-time CloudWatch monitoring, and automated rollback mechanisms, established a sustainable framework for managing runtime upgrades across their serverless architecture. This approach not only automated the upgrade process and minimized operational risks but also created a scalable solution that provides continuous runtime upgrades, preventing the use of deprecated runtimes at any point. By allowing continuous function runtime updates with minimal disruption to end user experience, Zapier maintains security and stability while requiring minimal manual intervention. This framework efficiently manages their growing serverless infrastructure, providing both security and operational efficiency for future runtime updates.</p><h2 id=conclusion>Conclusion</h2><p>In this post, you’ve learned how Zapier architected their <a href=https://aws.amazon.com/what-is/saas/>software-as-a-service</a> (SaaS) platform to provide secure, isolated execution environments using AWS Lambda and Amazon EKS, enabling their customers to create hundreds of thousands of Zaps. You’ve learned how Zapier’s team implemented the function runtime upgrade process at scale and reduced the number of functions running on soon-to-be deprecated runtimes by 95%. You’ve seen best practices that were established and techniques that helped Zapier to keep high security posture without impacting customer experience.
Use the following links to learn more about Lambda runtimes and upgrading your functions to the latest runtime versions:</p><ul><li><a href=https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html>Lambda runtimes documentation</a></li><li><a href=https://docs.aws.amazon.com/lambda/latest/dg/runtimes-list-deprecated.html>Retrieve data about Lambda functions that use a deprecated runtime</a></li><li><a href=https://aws.amazon.com/blogs/compute/managing-aws-lambda-runtime-upgrades/>Managing AWS Lambda runtime upgrades</a> in the AWS Compute Blog</li><li><a href=https://aws.amazon.com/blogs/compute/introducing-aws-lambda-runtime-management-controls/>AWS Lambda runtime management controls</a> in the AWS Compute Blog</li></ul><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/3.3-blog3/ title="Blog 3"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../3-blogstranslated/3.5-blog5/ title="Blog 5" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765465501></script><script src=../../js/perfect-scrollbar.min.js?1765465501></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765465501></script><script src=../../js/jquery.sticky.js?1765465501></script><script src=../../js/featherlight.min.js?1765465501></script><script src=../../js/highlight.pack.js?1765465501></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765465501></script><script src=../../js/learn.js?1765465501></script><script src=../../js/hugo-learn.js?1765465501></script><link href=../../mermaid/mermaid.css?1765465501 rel=stylesheet><script src=../../mermaid/mermaid.js?1765465501></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>