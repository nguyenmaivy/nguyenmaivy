<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="vynguyen08257@gmail.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 5 :: Internship Report</title>
<link href=../../css/nucleus.css?1765465501 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765465501 rel=stylesheet><link href=../../css/hybrid.css?1765465501 rel=stylesheet><link href=../../css/featherlight.min.css?1765465501 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765465501 rel=stylesheet><link href=../../css/auto-complete.css?1765465501 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765465501 rel=stylesheet><link href=../../css/theme.css?1765465501 rel=stylesheet><link href=../../css/hugo-theme.css?1765465501 rel=stylesheet><link href=../../css/theme-workshop.css?1765465501 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765465501></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.6-blog6/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765465501></script><script type=text/javascript src=../../js/auto-complete.js?1765465501></script><script type=text/javascript>var baseurl="https://nguyenmaivy.github.io/nguyenmaivy/"</script><script type=text/javascript src=../../js/search.js?1765465501></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Worklog Week 10" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Worklog Week 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Worklog Week 9" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Worklog Week 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Worklog Week 11" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Worklog Week 11
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2.</b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.4-blog4/ title="Blog 4" class=dd-item><a href=../../3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.5-blog5/ title="Blog 5" class=dd-item><a href=../../3-blogstranslated/3.5-blog5/><b>3.6. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.6-blog6/ title="Blog 5" class="dd-item
active"><a href=../../3-blogstranslated/3.6-blog6/><b>3.6. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.7-blog7/ title="Blog 7" class=dd-item><a href=../../3-blogstranslated/3.7-blog7/><b>3.7. </b>Blog 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.8-blog8/ title="Blog 8" class=dd-item><a href=../../3-blogstranslated/3.8-blog8/><b>3.8. </b>Blog 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.9-blog9/ title="Blog 9" class=dd-item><a href=../../3-blogstranslated/3.9-blog9/><b>3.9. </b>Blog 9
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title=Introduction class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title=Prerequiste class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>Prerequiste
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-s3-vpc/ title="Access S3 from VPC" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/><b>5.3. </b>Access S3 from VPC
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.3-s3-vpc/5.3.1-create-gwe/ title="Create a gateway endpoint" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/5.3.1-create-gwe/><b>5.3.1 </b>Create a gateway endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-s3-vpc/5.3.2-test-gwe/ title="Test the Gateway Endpoint" class=dd-item><a href=../../5-workshop/5.3-s3-vpc/5.3.2-test-gwe/><b>5.3.2 </b>Test the Gateway Endpoint
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.4-s3-onprem/ title="Access S3 from on-premises" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/><b>5.4. </b>Access S3 from on-premises
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.1-prepare/ title="Prepare the environment" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.1-prepare/><b>5.4.1 </b>Prepare the environment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/ title="Create an S3 Interface endpoint" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/><b>5.4.2 </b>Create an S3 Interface endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/ title="Test the Interface Endpoint" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/><b>5.4.3 </b>Test the Interface Endpoint
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/ title="On-premises DNS Simulation" class=dd-item><a href=../../5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/><b>5.4.4 </b>On-premises DNS Simulation
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.5-policy/ title="VPC Endpoint Policies" class=dd-item><a href=../../5-workshop/5.5-policy/><b>5.5. </b>VPC Endpoint Policies
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-cleanup/ title="Clean up" class=dd-item><a href=../../5-workshop/5.6-cleanup/><b>5.6. </b>Clean up
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing, Contributing Opinions" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing, Contributing Opinions
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://nguyenmaivy.github.io/nguyenmaivy/3-blogstranslated/3.6-blog6/ selected>English</option><option id=vi value=https://nguyenmaivy.github.io/nguyenmaivy/vi/3-blogstranslated/3.6-blog6/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 5</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#why-message-prioritization-matters>Why message prioritization matters</a></li><li><a href=#classic-queues-compared-to-quorum-queues-message-prioritization>Classic queues compared to quorum queues message prioritization</a><ul><li><a href=#message-prioritization-with-classic-queues>Message prioritization with classic queues</a></li><li><a href=#message-prioritization-with-quorum-queues>Message prioritization with quorum queues</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 5</h1><h1 id=implementing-message-prioritization-with-quorum-queues-on-amazon-mq-for-rabbitmq>Implementing message prioritization with quorum queues on Amazon MQ for RabbitMQ</h1><p>by Akhil Melakunta and Vinodh Kannan Sadayamuthu on 23 JUL 2025 in<a href=https://aws.amazon.com/blogs/compute/category/learning-levels/advanced-300/>Advanced (300)</a>, <a href=https://aws.amazon.com/blogs/compute/category/messaging/amazon-mq/>Amazon MQ</a>, <a href=https://aws.amazon.com/blogs/compute/category/serverless/>Serverless</a>, <a href=https://aws.amazon.com/blogs/compute/category/post-types/technical-how-to/>Technical How-to</a></p><p><a href=https://aws.amazon.com/blogs/compute/introducing-quorum-queues-on-amazon-mq-for-rabbitmq/>Quorum queues are now available on Amazon MQ for RabbitMQ from version 3.13.</a> Quorum queues are a replicated First-In, First-Out (FIFO) queue type that uses the <a href=https://raft.github.io/>Raft consensus algorithm</a> to maintain data consistency. Quorum queues on RabbitMQ version 3.13 lack one key feature compared to classic queues: message prioritization. However, RabbitMQ version 4.0 introduced support for <a href=https://www.rabbitmq.com/blog/2024/08/28/quorum-queues-in-4.0#message-priorities>message priority</a>, which behaves differently than classic queue message priorities. Migrating applications from classic queues with message priority to quorum queues on <a href=https://aws.amazon.com/amazon-mq/>Amazon MQ for RabbitMQ</a> presents challenges for customers. This post describes the different approaches to implementing message prioritization in quorum queues in Amazon MQ for RabbitMQ.</p><p>Amazon MQ is a managed message broker service for <a href=https://activemq.apache.org/>Apache ActiveMQ</a> and <a href=https://www.rabbitmq.com/>RabbitMQ</a> that simplifies setting up and operating message brokers on AWS.</p><h2 id=why-message-prioritization-matters>Why message prioritization matters</h2><p>Modern messaging systems require handling messages differently, depending on the business priority. Some messages are more time-sensitive or critical than others and prioritizing them can enhance the efficiency and responsiveness of applications. Message prioritization allows certain messages to be processed before others, aligning with business priorities and helping to ensure that high-value or time-critical messages receive the attention they need.</p><p>Message prioritization addresses critical business challenges across multiple industries. In insurance companies, it can expedite urgent claim processing by prioritizing high-priority messages over routine policy updates, reducing settlement times. Automotive manufacturers can make sure that critical production line alerts and safety notifications take precedence over standard telemetry data, preventing costly downtime. Energy utilities can prioritize real-time grid stability alerts and outage notifications, enabling faster responses to potential blackouts. By implementing message priority, industries can direct immediate attention to time-sensitive operations while efficiently managing routine processes within existing infrastructure. By using this approach to transform their communication strategies, organizations can respond more quickly and effectively to critical events.</p><h2 id=classic-queues-compared-to-quorum-queues-message-prioritization>Classic queues compared to quorum queues message prioritization</h2><p>In this section, explore the fundamental differences between classic queues and quorum queues when it comes to message prioritization capabilities. Examine how each queue type handles message priority, the built-in features available, and key considerations.</p><h3 id=message-prioritization-with-classic-queues>Message prioritization with classic queues</h3><p>In <a href=https://www.rabbitmq.com/docs/priority>classic queues</a>, RabbitMQ supports message priorities ranging from 1 to 255, with 1 being the lowest priority and 255 being the highest. However, it’s generally recommended to use a smaller range (for example, 1–5) for better performance, because RabbitMQ needs to maintain an internal sub-queue for each priority from 1 up to the maximum value configured for a given queue. A wider priority range adds more CPU and memory cost, which can impact broker performance.
Priority queue behavior in classic queues:</p><ul><li>Classic queues require x-max-priority argument to define the maximum number of priorities for a given queue</li><li>A procedure sends a message with a priority property value
Consumers don’t need special configuration to handle priorities
Messages with higher priority are delivered before messages with lower priority</li><li>Within the same priority level, messages are delivered in FIFO order</li><li>Messages without a priority property are treated as if their priority is lowest</li><li>Messages with a priority that is higher than the queue’s maximum are treated as if they were published with the maximum priority</li></ul><blockquote><p>*Image 1. *</p></blockquote><p>Example Python code for classic queue implementation with message priority:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pika
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> ssl
</span></span><span style=display:flex><span><span style=color:#75715e># Set up SSL context for secure connection</span>
</span></span><span style=display:flex><span>context <span style=color:#f92672>=</span> ssl<span style=color:#f92672>.</span>SSLContext(ssl<span style=color:#f92672>.</span>PROTOCOL_TLSv1_2)
</span></span><span style=display:flex><span><span style=color:#75715e># Define credentials</span>
</span></span><span style=display:flex><span>credentials <span style=color:#f92672>=</span> pika<span style=color:#f92672>.</span>PlainCredentials(<span style=color:#e6db74>&#39;username&#39;</span>, <span style=color:#e6db74>&#39;password&#39;</span>) <span style=color:#75715e># Replace with actual credentials</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set up connection parameters for Amazon MQ RabbitMQ broker</span>
</span></span><span style=display:flex><span>connection_parameters <span style=color:#f92672>=</span> pika<span style=color:#f92672>.</span>ConnectionParameters(
</span></span><span style=display:flex><span>    host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;b-example.mq.us-west-2.on.aws&#39;</span>, <span style=color:#75715e># Replace with actual broker endpoint</span>
</span></span><span style=display:flex><span>    port<span style=color:#f92672>=</span><span style=color:#ae81ff>5671</span>,
</span></span><span style=display:flex><span>    credentials<span style=color:#f92672>=</span>credentials,
</span></span><span style=display:flex><span>    ssl_options<span style=color:#f92672>=</span>pika<span style=color:#f92672>.</span>SSLOptions(context)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Establish connection and create a channel</span>
</span></span><span style=display:flex><span>connection <span style=color:#f92672>=</span> pika<span style=color:#f92672>.</span>BlockingConnection(connection_parameters)
</span></span><span style=display:flex><span>channel <span style=color:#f92672>=</span> connection<span style=color:#f92672>.</span>channel()
</span></span><span style=display:flex><span><span style=color:#75715e># Declare a direct exchange</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - direct exchanges route messages based on routing key</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>exchange_declare(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange&#39;</span>,
</span></span><span style=display:flex><span>    exchange_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;direct&#39;</span>,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Declare a priority queue</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - x-max-priority=5 sets maximum priority level (0-5)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - x-queue-type=classic specifies classic queue implementation</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_declare(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;classic_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    arguments<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;x-max-priority&#39;</span>: <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;x-queue-type&#39;</span>: <span style=color:#e6db74>&#34;classic&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Bind queue to exchange with routing key</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - This connects the queue to the exchange</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Messages sent to the exchange with matching routing key will be routed to this queue</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_bind(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;classic_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_queue&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Publish messages with different priorities</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Low priority message (priority=1)</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>basic_publish(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    body<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Low priority message&#39;</span>,
</span></span><span style=display:flex><span>    properties<span style=color:#f92672>=</span>pika<span style=color:#f92672>.</span>BasicProperties(priority<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Sent &#39;Low priority message&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Medium priority message (priority=2)</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>basic_publish(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    body<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Medium priority message&#39;</span>,
</span></span><span style=display:flex><span>    properties<span style=color:#f92672>=</span>pika<span style=color:#f92672>.</span>BasicProperties(priority<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Sent &#39;Medium priority message&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># High priority message (priority=5)</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>basic_publish(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    body<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;High priority message&#39;</span>,
</span></span><span style=display:flex><span>    properties<span style=color:#f92672>=</span>pika<span style=color:#f92672>.</span>BasicProperties(priority<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Sent &#39;High priority message&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Close the connection</span>
</span></span><span style=display:flex><span>connection<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><p>The preceding code demonstrates message prioritization in RabbitMQ using a classic queue with built-in priority handling. The implementation connects to a RabbitMQ broker using the <a href=https://pika.readthedocs.io/en/stable/>Python Pika library</a> and declares a direct exchange, a classic queue with a maximum priority level of 5. Messages are then published to this single queue with explicitly assigned priority values (1 for low, 2 for medium, and 5 for high priority). When consumers fetch messages from this queue, RabbitMQ will deliver higher priority messages first.</p><h3 id=message-prioritization-with-quorum-queues>Message prioritization with quorum queues</h3><p>Unlike classic queues, quorum queues in Rabbit MQ 3.13 don’t support message prioritization natively. However, there are effective patterns that you can implement to achieve message priority with Quorum queues.</p><h4 id=using-separate-queues-for-different-priorities><em>Using separate queues for different priorities</em></h4><p>A straightforward method is to create multiple quorum queues, each dedicated to different priority levels. For example, you might have a high-priority queue and a low-priority queue. Using RabbitMQ exchange and binding key route messages to the appropriate queues based on their priority, allowing the system to process high-priority messages more promptly, as shown in the following figure.</p><blockquote><p>*Image 2. *</p></blockquote><p>Example to implement priority handling using separate quorum queues:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pika
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> ssl
</span></span><span style=display:flex><span><span style=color:#75715e># Set up SSL context for secure connection</span>
</span></span><span style=display:flex><span>context <span style=color:#f92672>=</span> ssl<span style=color:#f92672>.</span>SSLContext(ssl<span style=color:#f92672>.</span>PROTOCOL_TLSv1_2)
</span></span><span style=display:flex><span><span style=color:#75715e># Define credentials</span>
</span></span><span style=display:flex><span>credentials <span style=color:#f92672>=</span> pika<span style=color:#f92672>.</span>PlainCredentials(<span style=color:#e6db74>&#39;username&#39;</span>, <span style=color:#e6db74>&#39;password&#39;</span>) <span style=color:#75715e>#Replace with actual credentials</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set up connection parameters for Amazon MQ RabbitMQ broker</span>
</span></span><span style=display:flex><span>connection_parameters <span style=color:#f92672>=</span> pika<span style=color:#f92672>.</span>ConnectionParameters(
</span></span><span style=display:flex><span>    host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;b-example.mq.us-west-2.on.aws&#39;</span>,
</span></span><span style=display:flex><span>    port<span style=color:#f92672>=</span><span style=color:#ae81ff>5671</span>,
</span></span><span style=display:flex><span>    credentials<span style=color:#f92672>=</span>credentials,
</span></span><span style=display:flex><span>    ssl_options<span style=color:#f92672>=</span>pika<span style=color:#f92672>.</span>SSLOptions(context)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Establish connection and create a channel</span>
</span></span><span style=display:flex><span>connection <span style=color:#f92672>=</span> pika<span style=color:#f92672>.</span>BlockingConnection(connection_parameters)
</span></span><span style=display:flex><span>channel <span style=color:#f92672>=</span> connection<span style=color:#f92672>.</span>channel()
</span></span><span style=display:flex><span><span style=color:#75715e># Declare a direct exchange</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Direct exchanges route messages based on routing key</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>exchange_declare(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>,
</span></span><span style=display:flex><span>    exchange_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;direct&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Create separate quorum queues for different priority levels</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Low priority queue</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_declare(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;low_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    durable<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>    arguments<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;x-queue-type&#39;</span>: <span style=color:#e6db74>&#34;quorum&#34;</span> 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Bind the low priority queue to the exchange with a specific routing key</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - This creates a rule that messages sent to &#39;priority_exchange&#39; with routing_key=&#39;low_priority_1&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - will be routed to the &#39;low_priority_queue&#39;</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_bind(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;low_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;low_priority_1&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Medium priority queue</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_declare(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;medium_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    durable<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>    arguments<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;x-queue-type&#39;</span>: <span style=color:#e6db74>&#34;quorum&#34;</span> 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Bind the medium priority queue to the exchange with a specific routing key</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Messages with routing_key=&#39;medium_priority_2&#39; will be directed to the &#39;medium_priority_queue&#39;</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_bind(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;medium_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;medium_priority_2&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># High priority queue</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_declare(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;high_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    durable<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>    arguments<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;x-queue-type&#39;</span>: <span style=color:#e6db74>&#34;quorum&#34;</span> 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Bind the high priority queue to the exchange with a specific routing key</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Messages with routing_key=&#39;high_priority_2&#39; will be directed to the &#39;high_priority_queue&#39;</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>queue_bind(
</span></span><span style=display:flex><span>    queue<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;high_priority_queue&#39;</span>,
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>,
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;high_priority_5&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Publish messages to different priority queues</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Publishing messages to different priority queues&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Low priority message</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>basic_publish(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>,  
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;low_priority_1&#39;</span>,
</span></span><span style=display:flex><span>    body<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Low priority message&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Sent &#39;Low priority message&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Medium priority message</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>basic_publish(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>, 
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;medium_priority_2&#39;</span>,
</span></span><span style=display:flex><span>    body<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Medium priority message&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Sent &#39;Medium priority message&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># High priority message</span>
</span></span><span style=display:flex><span>channel<span style=color:#f92672>.</span>basic_publish(
</span></span><span style=display:flex><span>    exchange<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;priority_exchange_qq&#39;</span>, 
</span></span><span style=display:flex><span>    routing_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;high_priority_5&#39;</span>,
</span></span><span style=display:flex><span>    body<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;High priority message&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Sent &#39;High priority message&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Close the connection</span>
</span></span><span style=display:flex><span>connection<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34; [x] Connection closed&#34;</span>)
</span></span></code></pre></div><p>The preceding code demonstrates a message prioritization approach in RabbitMQ using separate quorum queues for different priority levels (low, medium, and high). The implementation uses the Python Pika library to connect to a RabbitMQ server, a direct exchange and three separate quorum queues for different priority levels, and publish messages to different routing keys with different priority.</p><h4 id=custom-priority-logic-on-consumers><em>Custom priority logic on consumers</em></h4><p>Implement custom logic within your application to handle messages based on their priority. For example, you can use headers or metadata to determine the priority of a message and then use this information to route messages to different queues or handle them in a specific order.
Higher priority queues should use more consumers or consumers with higher resources allocated to process messages more quickly than lower priority queues. Use the basic.qos (<a href=https://www.rabbitmq.com/docs/confirms#channel-qos-prefetch>prefetch</a>) method in manual acknowledgement mode on your consumers to limit the number of messages that can be out for delivery at any time and allow messages to be prioritized. basic.qos is a value a consumer sets when connecting to a queue. It indicates how many messages the consumer can handle at one time. This method is shown in the following figure.</p><blockquote><p>*Image 3. *</p></blockquote><p><em>Note:</em> This solution implements message priority on a best-effort basis. There is a possibility that low and medium priority messages may be processed before high priority messages.</p><h2 id=conclusion>Conclusion</h2><p>Message prioritization in RabbitMQ brokers on Amazon MQ has different considerations for classic and quorum queues. Using quorum queues requires a thoughtful approach because of the lack of native support for message proritization in RabbitMQ. By employing separate queues and custom logic, you can achieve effective prioritization while maintaining the high availability and consistency that quorum queues offer. Embrace these strategies to optimize your messaging infrastructure, enhance application responsiveness, and make sure that critical messages are processed in a timely manner.
We recommend that you adopt quorum queues as the preferred replicated queue type on RabbitMQ 3.13 brokers. For more details, see <a href=https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/quorum-queues.html>Amazon MQ documentation</a>. For more information, see <a href=https://www.rabbitmq.com/docs/quorum-queues>quorum queues</a>.
To learn more, see <a href=https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/working-with-rabbitmq.html>Amazon MQ for Rabbit MQ</a>.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/3.5-blog5/ title="Blog 5"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../3-blogstranslated/3.7-blog7/ title="Blog 7" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765465501></script><script src=../../js/perfect-scrollbar.min.js?1765465501></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765465501></script><script src=../../js/jquery.sticky.js?1765465501></script><script src=../../js/featherlight.min.js?1765465501></script><script src=../../js/highlight.pack.js?1765465501></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765465501></script><script src=../../js/learn.js?1765465501></script><script src=../../js/hugo-learn.js?1765465501></script><link href=../../mermaid/mermaid.css?1765465501 rel=stylesheet><script src=../../mermaid/mermaid.js?1765465501></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>